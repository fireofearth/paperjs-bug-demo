<!DOCTYPE html>
    <html style="height: 100%;">
    <head>
        <meta charset="utf-8">
        <title>osd-spot-viewer</title>
        <script src="https://openseadragon.github.io/openseadragon/openseadragon.min.js"></script>       
        <script src="openseadragon-paperjs-overlay.js"></script>
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.9.25/paper-full.min.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.2/paper-full.min.js"></script>
    </head>
    <body style="height: 100%;">
        <h2>Drag the circles with the mouse!</h2>
        The circles are painted by <a href="http://paperjs.org/">Paper.js</a> on top of an
        <a href="https://openseadragon.github.io/">OpenSeadragon</a> windows by use of the the plugin
        <a href="https://github.com/eriksjolund/OpenSeadragonPaperjsOverlay">OpenSeadragonPaperjsOverlay</a>
        <br/>
        <br/>
        <div id="osd" style="width: 100%; height:100%;"></div>
        <script>                

var mock = "[\"Layer\",{\"applyMatrix\":true,\"data\":{\"labelSlug\":\"tumor\"},\"children\":[[\"Path\",{\"applyMatrix\":true,\"segments\":[[304.55058,230.92514],[304.55058,465.91378],[304.55058,700.90242],[304.37633,707.53275],[303.95314,719.30786],[303.43039,734.63144],[302.95742,751.90717],[302.75827,785.92989],[303.33081,799.48425],[304.55058,808.60555],[309.44618,818.39674],[314.34177,828.18794],[314.93545,837.90604],[314.34177,847.77032],[314.0495,869.69881],[314.37832,887.44955],[317.13666,904.94307],[319.99204,914.81853],[324.13297,926.09987],[331.00959,933.56843],[341.77285,936.92818],[353.50736,937.32157],[363.29774,935.89106],[373.02836,930.67116],[382.88013,926.09987],[412.28239,926.30565],[427.0153,927.0145],[441.62729,926.09987],[458.93602,921.98845],[475.8824,916.21391],[492.83582,910.48675],[510.16564,906.51748],[527.24072,905.64295],[544.44833,906.6086],[561.64919,907.52869],[578.70399,906.51748],[593.62693,902.6108],[608.09288,896.82182],[622.55118,890.98508],[637.45115,886.9351],[666.72482,885.72785],[696.19831,886.9351],[813.69263,886.9351],[828.42938,887.53872],[843.06621,886.9351],[847.80438,885.92456],[854.71531,884.14899],[872.19864,879.01153],[889.80254,872.94025],[896.86419,869.99742],[901.81337,867.35271],[906.601,862.27107],[911.60457,857.56152],[919.59675,853.73702],[926.10616,851.03016],[936.57211,848.22016],[946.79328,847.63304],[960.56053,847.77032],[980.14292,847.77032],[985.96558,848.95768],[988.52926,849.1061],[989.93411,847.77032],[991.49694,828.31969],[989.93411,808.60555],[980.14292,720.48481],[975.91285,681.21862],[970.35173,642.15526],[960.12789,603.06192],[950.76934,563.82572],[950.34066,534.50058],[950.76934,505.07856],[946.47939,475.6294],[940.97815,446.3314],[936.66425,416.83683],[931.18695,387.58424],[921.74263,358.11532],[911.60457,328.83708],[901.81337,289.6723],[891.61883,270.20737],[886.13511,260.65359],[882.23099,250.50753],[883.36816,240.07248],[883.95557,235.04159],[882.23099,230.92514],[878.09485,228.68766],[873.03112,228.42023],[862.6486,230.92514],[857.05537,234.63587],[852.66959,240.2629],[848.37771,246.11665],[843.06621,250.50753],[833.43588,254.92467],[825.09543,257.9097],[810.31188,260.62295],[794.77091,260.72628],[774.52786,260.29872],[749.95117,261.39341],[725.57189,260.29872],[710.68815,256.15841],[696.21785,250.3954],[681.73778,244.68845],[666.82473,240.71634],[637.52091,238.84425],[608.07757,240.71634],[585.75481,244.30072],[565.20409,250.43029],[527.44064,268.082],[490.83088,289.18546],[451.41848,309.25469],[448.27077,309.81523],[442.56126,310.15993],[426.8823,310.31321],[411.23244,309.93723],[405.5593,309.62036],[402.46251,309.25469],[392.61259,304.56077],[382.88013,299.4635],[377.91813,299.62381],[373.08893,299.4635],[367.41928,295.34196],[363.29774,289.6723],[363.61582,284.54745],[363.29774,279.88111],[361.03507,279.3013],[356.5156,279.21847],[343.71535,279.88111],[330.91511,280.54375],[326.39564,280.46092],[324.13297,279.88111],[322.83483,275.52322],[324.13297,270.08992],[325.43111,264.65661],[324.13297,260.29872],[319.63518,259.11527],[313.96871,260.60456],[308.48878,261.94093],[304.55058,260.29872],[302.2593,250.8953],[302.51389,238.8852],[303.78682,230.23847],[304.32782,229.042]],\"closed\":true,\"fillColor\":[1,0,0,0.5],\"strokeColor\":[0,0,0],\"strokeWidth\":2,\"strokeScaling\":false}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[1195.54917,250.50753],[1189.25632,254.23701],[1185.75798,260.29872],[1184.71947,289.5985],[1185.75798,319.04588],[1185.75798,387.58424],[1186.08203,515.05418],[1188.87631,578.44711],[1195.54917,642.15526],[1200.34768,672.95114],[1205.003,698.6663],[1209.42576,720.93855],[1213.52657,741.40569],[1217.21606,761.70552],[1220.40483,783.47584],[1223.00353,808.35444],[1224.92275,837.97913],[1225.62133,896.70967],[1224.92275,955.47345],[1222.9876,980.26547],[1222.7457,992.54371],[1224.92275,1004.42942],[1229.33995,1006.45594],[1234.71394,1004.42942],[1239.60954,994.63822],[1244.50514,984.84703],[1253.78369,979.24018],[1264.08752,975.05584],[1273.67151,969.60009],[1283.66991,965.26464],[1313.26943,961.10761],[1328.0752,959.18841],[1342.41707,955.47345],[1355.09657,949.05469],[1366.89505,940.78666],[1378.69354,932.51863],[1391.37304,926.09987],[1405.71491,922.3849],[1420.52068,920.4657],[1450.1202,916.30868],[1479.44699,906.31928],[1508.86736,896.72629],[1523.46671,895.92979],[1538.24094,896.72629],[1553.03736,895.83577],[1567.61452,896.72629],[1572.47583,901.7969],[1574.57789,904.86965],[1577.40571,906.51748],[1606.61323,908.85414],[1636.00526,908.59451],[1694.90003,906.51748],[1734.0648,906.51748],[1744.946,908.55417],[1749.97785,908.80876],[1753.64719,906.51748],[1755.93847,899.86783],[1755.68388,892.44735],[1753.64719,877.1439],[1753.64719,828.18794],[1754.76522,774.28987],[1753.64719,720.48481],[1745.27737,656.6596],[1734.0648,593.1993],[1724.11348,544.24363],[1712.81849,495.51936],[1702.35547,446.6791],[1694.90003,397.37543],[1694.28186,375.35713],[1695.55779,353.22571],[1696.50484,331.13897],[1694.90003,309.25469],[1691.76419,301.24829],[1686.35685,294.16207],[1675.31764,279.88111],[1669.45022,265.52776],[1665.52645,250.50753],[1666.14109,240.50545],[1665.52645,230.92514],[1663.70535,230.01816],[1660.94894,230.69588],[1658.03348,231.48824],[1655.73526,230.92514],[1645.47142,216.64828],[1636.15287,201.55156],[1630.99282,196.81941],[1626.36168,191.76037],[1626.67976,186.63551],[1626.36168,181.96918],[1621.82455,181.10375],[1616.57048,181.96918],[1606.77929,181.96918],[1567.61452,201.55156],[1560.96365,203.9192],[1551.6856,206.51083],[1528.70784,211.26453],[1505.60104,213.60954],[1496.16168,213.19032],[1489.28497,211.34276],[1483.85509,207.20926],[1479.36592,201.78448],[1469.70258,191.76037],[1459.85085,187.22952],[1446.66,183.24719],[1432.75144,181.07365],[1420.74662,181.96918],[1307.72769,214.86724]],\"closed\":true,\"fillColor\":[1,0,0,0.5],\"strokeColor\":[0,0,0],\"strokeWidth\":2,\"strokeScaling\":false}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[324.1572,1210.13144],[319.07282,1209.9637],[316.32942,1209.28239],[314.35657,1210.09758],[307.63076,1224.13743],[304.56081,1239.45476],[303.6445,1283.47294],[304.55854,1327.56735],[303.04764,1391.27326],[302.85779,1423.09935],[304.55381,1454.83589],[314.34425,1528.2673],[324.13478,1601.6987],[324.09941,1631.0724],[324.13297,1660.43937],[328.90471,1680.03568],[333.92416,1699.60414],[333.46938,1719.2653],[333.92416,1738.76891],[338.15026,1751.22476],[343.9661,1763.19626],[349.65657,1775.19308],[353.50655,1787.72488],[354.82017,1816.98001],[353.50655,1846.47204],[352.14875,1856.67434],[351.97903,1861.62133],[353.50655,1866.05443],[357.54843,1869.42035],[362.88065,1871.29196],[368.42141,1872.99261],[373.08893,1875.84562],[373.09101,1877.10863],[373.0908,1880.43294],[373.08689,1890.51927],[373.08401,1900.61217],[373.08507,1903.9447],[373.08893,1905.2192],[382.5782,1924.91219],[392.67132,1944.38397],[392.26044,1949.55051],[392.67132,1954.17517],[397.20845,1955.04059],[402.46251,1954.17517],[412.35694,1954.87854],[422.0449,1954.17517],[460.97173,1938.53437],[480.35578,1930.57155],[500.37445,1924.80159],[517.32187,1922.91138],[534.47725,1923.1214],[568.9128,1924.80159],[647.24235,1924.80159],[681.53676,1924.14451],[715.7807,1924.80159],[745.15127,1929.73775],[774.52786,1934.59278],[815.80929,1936.2345],[857.62196,1936.05209],[940.97815,1934.59278],[989.93411,1934.59278],[1006.25591,1937.64782],[1013.80368,1938.0297],[1019.30769,1934.59278],[1021.59897,1927.94313],[1021.34438,1920.52265],[1019.30769,1905.2192],[1019.30769,1885.63681],[1019.30769,1807.30727],[1016.94829,1675.02876],[1009.5165,1542.94505],[1004.15978,1484.2261],[999.72531,1425.45073],[998.7898,1342.33047],[999.72531,1259.00044],[999.72531,1161.08851],[1000.8864,1146.2133],[999.72531,1131.71493],[998.21898,1130.4087],[995.66658,1130.55384],[989.93411,1131.71493],[980.14292,1131.71493],[940.97815,1151.29732],[932.50092,1153.18163],[920.0624,1154.02614],[904.93101,1153.9067],[888.37515,1152.89921],[856.06361,1148.52353],[842.84474,1145.30711],[833.27502,1141.50612],[820.4987,1132.51226],[808.82633,1121.87052],[797.13931,1111.25538],[784.31905,1102.34135],[770.2487,1096.02959],[755.49341,1091.29134],[725.57189,1082.75896],[696.44522,1072.03803],[666.82473,1063.17658],[647.33742,1062.21647],[627.65996,1063.17658],[608.01096,1062.37174],[588.49519,1063.17658],[578.45231,1067.29819],[568.9128,1072.96777],[529.74803,1092.55016],[524.5815,1092.13927],[519.95683,1092.55016],[515.06124,1102.34135],[510.16564,1112.13254],[505.4993,1112.45063],[500.37445,1112.13254],[495.47885,1117.02814],[490.58325,1121.92374],[485.78032,1122.17424],[480.79206,1121.92374],[465.81223,1126.02717],[451.41848,1131.71493],[426.9405,1146.40172],[402.46251,1161.08851],[382.88013,1170.8797],[377.91813,1170.71939],[373.08893,1170.8797],[368.19334,1175.7753],[363.29774,1180.6709],[358.40214,1180.6709],[353.50655,1180.6709],[348.61095,1185.56649],[343.71535,1190.46209],[338.58804,1190.14156],[333.92416,1190.46209],[329.04283,1200.2989]],\"closed\":true,\"fillColor\":[1,0,0,0.5],\"strokeColor\":[0,0,0],\"strokeWidth\":2,\"strokeScaling\":false}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[715.7807,2208.74619],[713.50591,2207.11776],[714.48846,2201.68686],[716.11713,2194.89004],[715.7807,2189.16381],[711.56166,2188.06912],[705.98951,2189.16381],[686.40712,2189.16381],[661.71351,2187.55366],[649.44756,2187.35239],[637.45115,2189.16381],[622.1147,2194.80681],[607.5001,2202.33914],[578.70399,2218.53739],[553.99632,2229.68148],[525.55919,2242.69972],[499.21648,2258.32359],[488.65049,2267.34122],[480.79206,2277.28455],[475.81363,2288.45677],[471.85954,2302.69889],[466.42181,2335.56195],[464.63685,2351.76748],[463.27361,2366.21209],[462.18144,2377.68805],[461.20967,2384.98767],[456.44111,2394.80743],[451.41848,2404.57006],[450.8248,2414.28817],[451.41848,2424.15245],[451.41848,2473.10841],[450.33722,2512.33307],[451.41848,2551.43796],[455.19684,2571.21494],[460.89691,2590.64244],[466.75336,2610.05008],[471.00087,2629.76751],[470.62961,2644.52702],[471.00087,2659.14109],[480.30636,2683.7605],[490.58325,2708.09705],[500.90032,2745.05732],[510.31068,2783.30349],[522.09632,2820.66342],[529.90549,2838.33224],[539.53922,2854.96495],[549.03449,2864.9771],[559.12161,2874.54734],[595.53193,2921.01428],[615.35939,2943.50178],[637.45115,2962.66808],[656.59187,2973.19285],[676.61593,2982.25047],[695.72676,2993.41603],[705.45901,2998.48342],[715.7807,3001.83285],[730.31837,3003.20372],[745.04183,3002.60817],[774.52786,3001.83285],[799.00584,3006.72845],[823.48383,3011.62405],[852.82725,3012.28888],[882.23099,3011.62405],[921.39576,3011.62405],[931.34281,3012.48352],[940.97815,3011.62405],[961.88416,3003.37681],[977.89259,2996.0453],[990.38892,2988.95109],[1000.75864,2981.41575],[1010.38724,2972.76084],[1020.66022,2962.30795],[1032.96307,2949.37865],[1048.68127,2933.2945],[1069.31883,2914.57715],[1079.24192,2904.89408],[1087.84605,2894.12973],[1093.89483,2883.64062],[1099.70716,2871.04634],[1110.4364,2842.05329],[1119.66166,2812.17268],[1127.01082,2786.4266],[1137.65597,2757.24553],[1146.59321,2727.67944],[1147.73551,2716.74594],[1147.57232,2707.11793],[1145.28771,2689.82016],[1143.65585,2671.86964],[1144.30859,2661.4257],[1146.59321,2649.34989],[1150.24242,2641.48052],[1155.81578,2634.47924],[1161.67345,2627.56989],[1166.17559,2619.97631],[1166.31062,2610.23458],[1166.17559,2600.39393],[1176.19397,2580.88182],[1185.75798,2561.22915],[1186.09859,2556.5486],[1186.34189,2546.43844],[1186.48787,2532.70855],[1186.53653,2517.16878],[1186.48787,2501.62902],[1186.34189,2487.89912],[1186.09859,2477.78896],[1185.75798,2473.10841],[1181.57048,2463.04178],[1175.96679,2453.52603],[1170.36309,2444.01027],[1166.17559,2433.94364],[1165.41907,2426.7062],[1166.17559,2419.25685],[1166.93211,2411.8075],[1166.17559,2404.57006],[1161.92203,2394.52112],[1156.20823,2385.03485],[1150.58252,2375.52499],[1146.59321,2365.40529],[1145.83798,2355.68433],[1146.95397,2345.71784],[1147.88959,2335.80389],[1146.59321,2326.24051],[1142.88248,2320.64728],[1137.25545,2316.2615],[1131.4017,2311.96963],[1127.01082,2306.65813],[1123.78838,2297.15349],[1122.11522,2287.07574],[1120.44207,2276.99799],[1117.21963,2267.49335],[1113.13832,2262.03045],[1107.80052,2257.48623],[1097.63724,2247.91097],[1097.63724,2243.01537],[1097.63724,2238.11977],[1085.46107,2223.27536],[1069.75891,2207.86968],[1053.30913,2192.90225],[1038.89008,2179.37261],[1019.30769,2159.79023],[1009.26228,2155.18775],[999.72531,2149.99903],[999.18711,2147.64069],[1000.02097,2144.62504],[1000.707,2141.84859],[999.72531,2140.20784],[987.8396,2138.03079],[975.56135,2138.27269],[950.76934,2140.20784],[920.25961,2142.46793],[889.96267,2148.56867],[859.93443,2157.49076],[830.2308,2168.21491],[772.02104,2190.99221],[743.62674,2201.00676]],\"closed\":true,\"fillColor\":[1,0,0,0.5],\"strokeColor\":[0,0,0],\"strokeWidth\":2,\"strokeScaling\":false}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[1773.22958,2287.07574],[1775.51044,2292.9914],[1780.94374,2297.55928],[1787.41556,2301.78098],[1792.81196,2306.65813],[1797.72681,2314.70681],[1802.21902,2324.76558],[1810.07043,2348.58831],[1816.636,2373.47613],[1822.18554,2394.77887],[1827.84154,2414.20606],[1831.97674,2433.94364],[1832.33354,2448.64886],[1831.10654,2463.47977],[1830.31464,2478.22941],[1831.97674,2492.6908],[1836.87233,2502.48199],[1841.76793,2512.27319],[1843.43673,2523.51343],[1843.50804,2536.10913],[1840.40022,2563.22671],[1835.52845,2589.34551],[1833.39484,2600.69274],[1831.97674,2610.18512],[1832.78515,2634.80839],[1833.39304,2647.09361],[1831.97674,2659.14109],[1827.08114,2668.93228],[1822.18554,2678.72347],[1822.68655,2688.7],[1822.18554,2698.30586],[1818.10424,2703.76877],[1812.76644,2708.31298],[1802.60316,2717.88825],[1802.78969,2722.93676],[1802.60316,2727.67944],[1798.06603,2728.54487],[1792.81196,2727.67944],[1772.94655,2728.50656],[1753.64719,2727.67944],[1738.27185,2723.92918],[1725.56261,2718.63015],[1714.65667,2710.51237],[1704.69122,2698.30586],[1704.87775,2693.25734],[1704.69122,2688.51467],[1699.21659,2684.30218],[1691.09111,2679.50417],[1670.42205,2668.93228],[1649.75299,2658.36039],[1641.6275,2653.56238],[1636.15287,2649.34989],[1631.25727,2639.5587],[1626.36168,2629.76751],[1620.10371,2624.85787],[1612.09536,2620.47372],[1593.00865,2612.93829],[1573.46387,2606.47407],[1557.82332,2600.39393],[1553.91689,2597.54553],[1547.72941,2592.05925],[1531.80882,2576.5796],[1516.65649,2560.76811],[1511.42934,2554.86705],[1508.86736,2551.43796],[1507.92611,2546.78598],[1508.54673,2541.77957],[1508.86736,2531.85557],[1503.76387,2527.01519],[1499.07616,2522.06438],[1498.5738,2515.94675],[1498.23088,2504.60107],[1498.03946,2489.76687],[1497.99157,2473.18372],[1498.07926,2456.59115],[1498.29456,2441.72871],[1498.62952,2430.33596],[1499.07616,2424.15245],[1503.55625,2414.25805],[1508.86736,2404.57006],[1508.86736,2394.77887],[1517.60621,2379.57739],[1528.44974,2365.40529],[1535.23349,2353.28948],[1539.56082,2341.93298],[1543.22821,2330.07364],[1548.03213,2316.44932],[1557.82332,2296.86693],[1558.45964,2293.24779],[1558.86842,2287.43102],[1559.09485,2272.17109],[1558.68551,2257.02008],[1558.29959,2251.33948],[1557.82332,2247.91097],[1553.28037,2238.00575],[1548.03213,2228.32858],[1543.6904,2213.36706],[1538.24094,2198.955],[1529.11651,2188.64321],[1518.65855,2179.37261],[1514.08718,2174.02718],[1508.86736,2169.58142],[1499.33459,2168.48673],[1489.28497,2169.58142],[1474.21055,2167.93939],[1466.8187,2167.73413],[1459.91139,2169.58142],[1455.01579,2174.47702],[1450.1202,2179.37261],[1445.2246,2179.37261],[1440.329,2179.37261],[1430.21093,2188.6349],[1420.74662,2198.955],[1406.45144,2208.77877],[1389.19006,2220.63675],[1373.02017,2233.89284],[1361.99946,2247.91097],[1361.45211,2252.67735],[1361.99946,2257.70216],[1361.99946,2316.44932],[1359.54892,2341.7662],[1354.64875,2364.48987],[1350.97614,2387.67125],[1350.74929,2400.38699],[1352.20826,2414.36125],[1355.74888,2429.54693],[1361.99946,2443.73483],[1372.02356,2453.39817],[1377.44835,2457.88734],[1381.58184,2463.31722],[1382.47246,2467.98775],[1381.76744,2473.02507],[1381.58184,2482.89961],[1391.61646,2497.49723],[1397.14917,2504.51034],[1401.16423,2512.27319],[1402.2441,2519.42334],[1401.7217,2526.82151],[1401.16423,2541.64677],[1405.93707,2556.35606],[1410.95542,2571.02035],[1410.34079,2581.02243],[1410.95542,2590.60273],[1420.13223,2600.78703],[1430.53781,2610.18512],[1441.44679,2624.22054],[1450.1202,2639.5587],[1449.9346,2649.43324],[1449.22958,2654.47056],[1450.1202,2659.14109],[1454.34104,2664.52302],[1459.91139,2668.93228],[1465.48174,2673.34154],[1469.70258,2678.72347],[1472.05571,2690.35342],[1470.50415,2702.86944],[1468.55181,2715.55146],[1469.70258,2727.67944],[1473.71764,2735.44228],[1479.25035,2742.4554],[1489.28497,2757.05302],[1489.71401,2766.71667],[1489.28497,2776.63541],[1493.19943,2789.15776],[1498.77022,2801.18219],[1508.86736,2825.59137],[1508.36635,2835.5679],[1508.86736,2845.17376],[1517.43731,2855.98417],[1528.44974,2864.75615],[1538.49516,2869.35862],[1548.03213,2874.54734],[1552.92773,2884.33853],[1557.82332,2894.12973],[1567.27258,2899.44242],[1577.40571,2903.92092],[1596.60638,2919.26547],[1616.57048,2933.2945],[1626.17634,2933.79551],[1636.15287,2933.2945],[1645.9155,2938.31713],[1655.73526,2943.08569],[1670.61336,2942.44214],[1678.03414,2941.82163],[1685.10884,2943.08569],[1690.57917,2947.10967],[1694.90003,2952.87689],[1699.22089,2958.6441],[1704.69122,2962.66808],[1710.01283,2963.13802],[1721.50918,2963.35861],[1737.0811,2963.38738],[1754.62942,2963.28188],[1772.05496,2963.09966],[1787.25855,2962.89825],[1798.14101,2962.73521],[1802.60316,2962.66808],[1871.14151,2962.66808],[1900.51509,2962.66808],[1905.5399,2963.21542],[1910.30628,2962.66808],[1915.39843,2958.07968],[1920.09748,2952.87689],[1959.26225,2923.50331],[1969.81247,2919.36674],[1974.93098,2917.23444],[1978.84464,2913.71211],[1979.72308,2909.01016],[1978.47158,2903.61508],[1977.4066,2898.37293],[1978.84464,2894.12973],[1983.20253,2892.83158],[1988.63583,2894.12973],[1994.06913,2895.42787],[1998.42702,2894.12973],[2000.19422,2890.02286],[1999.67783,2885.00794],[1998.42702,2874.54734],[2003.44538,2859.88305],[2008.21822,2845.17376],[2010.27155,2821.80426],[2010.0434,2796.598],[2008.90266,2771.20163],[2008.21822,2747.26183],[2008.21822,2561.22915],[2009.99925,2531.63632],[2010.22188,2516.92212],[2008.21822,2502.48199],[2003.19558,2492.71937],[1998.42702,2482.89961],[1998.11242,2468.26166],[1998.42702,2453.52603],[1988.63583,2394.77887],[1988.63583,2375.19648],[1978.84464,2336.03171],[1969.05344,2306.65813],[1963.67817,2297.00953],[1959.26225,2287.07574],[1959.26225,2272.38895],[1959.26225,2257.70216],[1949.88466,2223.33998],[1939.67986,2189.16381],[1939.67986,2174.47702],[1939.67986,2159.79023],[1935.34441,2149.79182],[1929.88867,2140.20784],[1925.70433,2129.904],[1920.09748,2120.62545],[1916.00844,2118.67824],[1911.02323,2118.8946],[1900.51509,2120.62545],[1895.26102,2119.76003],[1890.7239,2120.62545],[1890.7239,2125.52105],[1890.7239,2130.41665],[1885.8283,2130.41665],[1880.9327,2130.41665],[1874.7657,2139.48798],[1871.14151,2149.99903],[1871.32189,2159.84275],[1871.14151,2169.58142],[1867.43078,2175.17465],[1861.80375,2179.56043],[1855.95,2183.85231],[1851.55912,2189.16381],[1850.79721,2192.92141],[1850.69465,2198.98851],[1851.58428,2214.78185],[1852.46133,2230.00515],[1852.34305,2235.35972],[1851.55912,2238.11977],[1848.74617,2238.96784],[1843.41087,2239.09418],[1828.32847,2238.14053],[1812.6224,2237.1765],[1806.50752,2237.28986],[1802.60316,2238.11977],[1796.9335,2242.24131],[1792.81196,2247.91097],[1792.81196,2252.80656],[1792.81196,2257.70216],[1787.53205,2265.0773],[1781.04729,2271.92308],[1775.54927,2279.00179]],\"closed\":true,\"fillColor\":[1,0,0,0.5],\"strokeColor\":[0,0,0],\"strokeWidth\":2,\"strokeScaling\":false}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[1675.31764,1190.46209],[1676.18307,1194.99921],[1675.31764,1200.25328],[1677.23786,1239.60819],[1677.47788,1259.21435],[1675.31764,1278.58283],[1665.08178,1317.66897],[1655.73526,1356.91238],[1655.29223,1369.15217],[1656.41489,1381.53483],[1657.19773,1393.84525],[1655.73526,1405.86834],[1650.21057,1421.2672],[1642.87544,1435.98582],[1626.36168,1464.6155],[1615.97687,1479.02794],[1606.77929,1493.98908],[1603.60598,1506.02095],[1601.88369,1518.46707],[1600.16141,1530.91318],[1596.9881,1542.94505],[1587.38576,1557.70767],[1577.40571,1572.31863],[1572.29415,1591.8143],[1567.61452,1611.4834],[1558.12445,1631.18904],[1548.03213,1650.64817],[1538.51166,1675.25392],[1528.44974,1699.60414],[1514.11211,1724.26899],[1499.07616,1748.56011],[1489.28497,1768.14249],[1483.84906,1772.79907],[1479.49378,1777.93369],[1479.00331,1785.25223],[1479.96689,1792.77346],[1480.69392,1800.2182],[1479.49378,1807.30727],[1475.70776,1812.90278],[1470.33715,1817.43226],[1459.91139,1826.88965],[1450.1202,1846.47204],[1440.329,1866.05443],[1430.69463,1875.95657],[1420.74662,1885.63681],[1410.95542,1905.2192],[1396.50386,1920.07241],[1381.58184,1934.59278],[1376.97937,1944.6382],[1371.79065,1954.17517],[1366.55385,1957.88209],[1360.0643,1961.00592],[1354.54233,1963.16217],[1352.20826,1963.96636],[1371.79065,1954.17517],[1386.50841,1946.72037],[1398.20472,1941.52828],[1411.38078,1937.76404],[1419.93035,1936.15647],[1430.53781,1934.59278],[1484.30073,1928.80977],[1538.24094,1924.80159],[1589.44388,1922.89127],[1640.97497,1923.10353],[1743.856,1924.80159],[1783.02077,1924.80159],[1797.81719,1925.69211],[1812.39435,1924.80159],[1837.01377,1915.49609],[1861.35032,1905.2192],[1867.86142,1904.19311],[1878.43,1903.71147],[1906.19832,1903.879],[1933.57283,1904.71663],[1943.64913,1905.07262],[1949.47106,1905.2192],[2096.33896,1905.2192],[2131.84738,1905.74678],[2148.53184,1903.05895],[2164.87731,1895.42801],[2171.21306,1891.30316],[2174.6685,1885.63681],[2173.3399,1880.5046],[2170.30962,1875.79248],[2164.87731,1866.05443],[2165.31832,1851.25052],[2165.91351,1843.83901],[2164.87731,1836.68085],[2160.93244,1828.88803],[2155.5167,1821.82497],[2145.29492,1807.30727],[2131.54997,1767.65533],[2124.81589,1747.80843],[2115.92134,1728.97772],[2107.47124,1718.17977],[2097.10101,1708.88005],[2086.34976,1699.83797],[2076.75657,1689.81295],[2061.47073,1665.75349],[2047.38299,1640.85698],[2027.8006,1611.4834],[2016.15945,1587.89865],[2006.57381,1563.32142],[1988.63583,1513.57147],[1969.05344,1474.4067],[1969.2778,1469.39308],[1969.05344,1464.6155],[1958.89016,1455.04024],[1953.55236,1450.49602],[1949.47106,1445.03312],[1948.52981,1440.38114],[1949.15043,1435.37473],[1949.47106,1425.45073],[1944.80218,1420.46122],[1939.67986,1415.65954],[1934.49081,1401.10453],[1929.88867,1386.28596],[1924.72852,1376.5852],[1920.09748,1366.70357],[1915.94576,1341.96111],[1913.95886,1329.59987],[1910.30628,1317.7476],[1906.29299,1312.26941],[1900.69958,1307.87084],[1895.01392,1303.51506],[1890.7239,1298.16522],[1890.00154,1293.40618],[1890.987,1288.22134],[1891.84091,1283.11284],[1890.7239,1278.58283],[1886.68201,1275.21691],[1881.3498,1273.3453],[1875.80903,1271.64465],[1871.14151,1268.79164],[1869.60481,1264.60569],[1870.50534,1259.45896],[1871.72396,1254.08298],[1871.14151,1249.20925],[1866.92067,1243.82732],[1861.35032,1239.41806],[1855.77996,1235.0088],[1851.55912,1229.62686],[1851.87721,1224.502],[1851.55912,1219.83567],[1846.89279,1219.51759],[1841.76793,1219.83567],[1836.09827,1215.71413],[1831.97674,1210.04448],[1832.29482,1204.91962],[1831.97674,1200.25328],[1827.79079,1198.71658],[1822.64407,1199.61712],[1817.26808,1200.83574],[1812.39435,1200.25328],[1807.49875,1195.35769],[1802.60316,1190.46209],[1796.15604,1189.85158],[1787.39679,1191.05095],[1778.89733,1191.95588],[1773.22958,1190.46209],[1772.91149,1185.79575],[1773.22958,1180.6709],[1769.10804,1175.00124],[1763.43838,1170.8797],[1756.53107,1169.03242],[1749.13923,1169.23767],[1734.0648,1170.8797],[1717.01936,1171.75402],[1698.04854,1174.84308],[1679.95127,1180.84605],[1665.52645,1190.46209],[1665.75818,1191.11116],[1668.69119,1190.46209],[1672.48963,1189.81302]],\"closed\":true,\"fillColor\":[1,0,0,0.5],\"strokeColor\":[0,0,0],\"strokeWidth\":2,\"strokeScaling\":false}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[[3600,4000],[0,220.9139],[0,-220.9139]],[[4000,3600],[-220.9139,0],[220.9139,0]],[[4400,4000],[0,-220.9139],[0,220.9139]],[[4000,4400],[220.9139,0],[-220.9139,0]]],\"closed\":true,\"fillColor\":[1,0,0]}],[\"Path\",{\"applyMatrix\":true,\"segments\":[[[4600,5000],[0,220.9139],[0,-220.9139]],[[5000,4600],[-220.9139,0],[220.9139,0]],[[5400,5000],[0,-220.9139],[0,220.9139]],[[5000,5400],[220.9139,0],[-220.9139,0]]],\"closed\":true,\"fillColor\":[1,0,0]}]]}]"

var circles = [];
var paintCircles = function(jsondata, overlay) {
};
var hit_item = null;
var drag_handler = function(event) {
    if (hit_item) {
        var transformed_point1 = paper.view.viewToProject(new paper.Point(0,0));
        var transformed_point2 = paper.view.viewToProject(new paper.Point(event.delta.x, event.delta.y));
        hit_item.position = hit_item.position.add(transformed_point2.subtract(transformed_point1));
        window.viewer.setMouseNavEnabled(false);
        paper.view.draw();
    }
};
var dragEnd_handler = function(event) {
    if (hit_item) {
        window.viewer.setMouseNavEnabled(true);
    }
    hit_item = null;
};
var press_handler = function(event) {
    hit_item = null;
    var transformed_point = paper.view.viewToProject(new paper.Point(event.position.x, event.position.y));
    var hit_test_result = paper.project.hitTest(transformed_point);
    if (hit_test_result) {
        hit_item = hit_test_result.item;
    }
};
window.onload = function() {
    this.viewer = OpenSeadragon({
        id: "osd",
        prefixUrl: "https://openseadragon.github.io/openseadragon/images/",
        debugMode:  false,
        visibilityRatio: 1.0,
        constrainDuringPan: true,
        showNavigator: true,
        zoomPerScroll: 1.8
    });
    var overlay = this.viewer.paperjsOverlay();
    var paint_circles = function(overlay, event) {
        paper.project.activeLayer.importJSON(mock);
        // var circles = [
        //     {
        //         "pixel_x": 4000,
        //         "pixel_y": 4000,
        //         "radius": 400
        //     },
        //     {
        //         "pixel_x": 5000,
        //         "pixel_y": 5000,
        //         "radius": 400
        //     }
        // ];
        // var num_circles = circles.length;
        // for (var i = 0; i < num_circles; i++) {
        //     var circle = circles[i];
        //     var circle = new paper.Path.Circle(new paper.Point(circle.pixel_x, circle.pixel_y), circle.radius);
        //     circle.fillColor = 'red';
        //     circle.visible = true;
        //     circles.push(circle);
        //     circle.onMouseDown = function (event) {
        //         console.log("circle.onMouseDown" , "event.point.x = ", event.point.x , "event.point.y = ", event.point.y);
        //     };
        // }
        paper.project.activeLayer.children.forEach(child => {
            child.selected = true;
        });
        overlay.resize();
        overlay.resizecanvas();
    }.bind(null, overlay);
    new OpenSeadragon.MouseTracker({
        element: this.viewer.canvas,
        pressHandler: press_handler,
        dragHandler: drag_handler,
        dragEndHandler: dragEnd_handler
    }).setTracking(true);
    this.viewer.addTiledImage({
        tileSource: "http://openseadragon.github.io/example-images/highsmith/highsmith.dzi",
        x: 0,
        y: 0,
        success: paint_circles
    });
    window.onresize = function() {
        overlay.resize();
        overlay.resizecanvas();
    };   
};

        </script>
    </body>
</html>
